<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Megistos API: User Account Handling</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>User Account Handling</h1>This part of the API defines structures used to manage user accounts and operators on them.  
<a href="#_details">More...</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__UPF__flags.html">User preference flags</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User preference flags. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__USY__flags.html">Sysop commands and privileges</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sysop command and privilege constants. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__UFL__flags.html">User account flags (UFL_x)</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User account flags. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__USX__flags.html">User sexes (USX_x)</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User sexes. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__CLF__flags.html">Club Flags (CLF_x)</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flags used to describe clubs in the club header. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__OLF__FLAGS.html">Online user flags (OLF_x)</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Temporary user state and preferences. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__PGS__flags.html">Page states (PGS_x)</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User paging restrictions. <br><br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align=right valign=top>group &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__user__shm.html">Users and shared memory</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Shared user particulars. <br><br></td></tr>

<p>
<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structuseracc__t.html">useracc_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User account structure.  <a href="structuseracc__t.html#_details">More...</a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structclassrec__t.html">classrec_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User class.  <a href="structclassrec__t.html#_details">More...</a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structonlinerec__t.html">onlinerec_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User online structure.  <a href="structonlinerec__t.html#_details">More...</a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structinjoth__buf.html">injoth_buf</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga17">DELIM</a>&nbsp;&nbsp;&nbsp;"!@#$%^&amp;*-_=+.:"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga18">USR_MAGIC</a>&nbsp;&nbsp;&nbsp;"USER"</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User account magic.  <a href="#ga18"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga19">ML</a>&nbsp;&nbsp;&nbsp;NUMLANGUAGES</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga20">ONL_MAGIC</a>&nbsp;&nbsp;&nbsp;"OUSR"</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga21">CRD_PAID</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga22">CRD_FREE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga23">STF_FIRST</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga24">INJ_MESSAGE</a>&nbsp;&nbsp;&nbsp;1	/**&lt; Simple injected message */</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple injected message.  <a href="#ga24"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga25">INJ_MESSAGE_ACK</a>&nbsp;&nbsp;&nbsp;2	/**&lt; Injected message with acknowledgement */</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Injected message with acknowledgement.  <a href="#ga25"></a><br><br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structclassrec__t.html">classrec_t</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga2">cls_find</a> (char *s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a user class.  <a href="#ga2"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga3">usr_exists</a> (char *uid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check for the existence of a user.  <a href="#ga3"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga4">usr_loadaccount</a> (char *whose, <a class="el" href="structuseracc__t.html">useracc_t</a> *uacc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a user account from file.  <a href="#ga4"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga5">usr_loadonlrec</a> (char *whose, <a class="el" href="structonlinerec__t.html">onlinerec_t</a> *onlrec)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a user online structure from file.  <a href="#ga5"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga6">usr_saveaccount</a> (<a class="el" href="structuseracc__t.html">useracc_t</a> *uacc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a user account to disk.  <a href="#ga6"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga7">usr_saveonlrec</a> (<a class="el" href="structonlinerec__t.html">onlinerec_t</a> *onlrec)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a user online record to disk.  <a href="#ga7"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga8">usr_postcredits</a> (char *userid, int amount, int paid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Post credits to a user account.  <a href="#ga8"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga9">usr_chargecredits</a> (int amount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Charge a user's account.  <a href="#ga9"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga10">usr_canpay</a> (int amount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if the user has enough credits.  <a href="#ga10"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga11">usr_setclass</a> (char *userid, char *newclass, int permanent)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change a user's class.  <a href="#ga11"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga12">usr_insystem</a> (char *userid, int checkinvis, struct <a class="el" href="structshmuserrec.html">shmuserrec</a> **buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if a user is online (deprecated).  <a href="#ga12"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga13">usr_insys</a> (char *userid, int checkinvis)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if a user is online and attach shared segment.  <a href="#ga13"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga14">usr_injoth</a> (<a class="el" href="structonlinerec__t.html">onlinerec_t</a> *user, char *msg, int force)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Page another user with a message.  <a href="#ga14"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga15">usr_injoth_ack</a> (<a class="el" href="structonlinerec__t.html">onlinerec_t</a> *user, char *msg, char *ack, int force)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Page another user with a message and acknowledgement.  <a href="#ga15"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga16">usr_uidxref</a> (char *userid, int online)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User ID completion.  <a href="#ga16"></a><br><br></td></tr>
<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structclassrec__t.html">classrec_t</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga0">cls_classes</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Array of all defined user classes.  <a href="#ga0"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__useracc.html#ga1">cls_count</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of classes in <code>cls_classes</code>.  <a href="#ga1"></a><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This part of the API defines structures used to manage user accounts and operators on them. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="ga22" doxytag="useracc.h::CRD_FREE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CRD_FREE&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01051">1051</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga21" doxytag="useracc.h::CRD_PAID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CRD_PAID&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01050">1050</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga17" doxytag="useracc.h::DELIM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DELIM&nbsp;&nbsp;&nbsp;"!@#$%^&amp;*-_=+.:"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l00138">138</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga24" doxytag="useracc.h::INJ_MESSAGE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define INJ_MESSAGE&nbsp;&nbsp;&nbsp;1	/**&lt; Simple injected message */          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Simple injected message. 
<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01138">1138</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga25" doxytag="useracc.h::INJ_MESSAGE_ACK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define INJ_MESSAGE_ACK&nbsp;&nbsp;&nbsp;2	/**&lt; Injected message with acknowledgement */          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Injected message with acknowledgement. 
<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01139">1139</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga19" doxytag="useracc.h::ML" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ML&nbsp;&nbsp;&nbsp;NUMLANGUAGES          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l00748">748</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga20" doxytag="useracc.h::ONL_MAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ONL_MAGIC&nbsp;&nbsp;&nbsp;"OUSR"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l00874">874</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga23" doxytag="useracc.h::STF_FIRST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define STF_FIRST&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01053">1053</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga18" doxytag="useracc.h::USR_MAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USR_MAGIC&nbsp;&nbsp;&nbsp;"USER"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
User account magic. 
<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l00271">271</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga2" doxytag="useracc.h::cls_find" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structclassrec__t.html">classrec_t</a>* cls_find           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>s</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find a user class. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>s</em>&nbsp;</td><td>The name of a class to look for. The match is full-string and case sensitive.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A pointer to the <code><a class="el" href="structclassrec__t.html">classrec_t</a></code> for the required class, or <code>NULL</code> if the class could not be located. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga10" doxytag="useracc.h::usr_canpay" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_canpay           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>amount</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check if the user has enough credits. 
<p>
Checks if the current user has enough credits, presumably as a preamble to charging the user's account. Don't forget that credits are a constantly diminishing quantity. Always check if a user can pay, but do it right before charging the user. Otherwise, the user may be able to pay now, but not when you actually call <code><a class="el" href="group__useracc.html#ga9">usr_chargecredits()</a></code>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>amount</em>&nbsp;</td><td>The number of credits to check for.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Non-zero if the user's credits are greater than or equal to { amount}. Zero otherwise.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga8">usr_postcredits()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga9" doxytag="useracc.h::usr_chargecredits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void usr_chargecredits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>amount</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Charge a user's account. 
<p>
Debits (i.e removes) the specified amount of credits from this user's account. There is purposefully no functionality to debit other users' accounts. You can use <code><a class="el" href="group__useracc.html#ga10">usr_canpay()</a></code> to determine if the user has enough credits to cover the <code>amount</code>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>amount</em>&nbsp;</td><td>The amount of credits to debit to the current user.</td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga8">usr_postcredits()</a>, <a class="el" href="group__useracc.html#ga10">usr_canpay()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga3" doxytag="useracc.h::usr_exists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_exists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>uid</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check for the existence of a user. 
<p>
Checks if the specified user exists. If the user does exist, the canonical form of the user ID (i.e. the properly capitalised version of the ID provided) overwrites the provided user ID.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>uid</em>&nbsp;</td><td>A user ID to look for. The match is case insensitive. The properly capitalised user ID overwrites this string on success.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user could not be located. One if the user is located, in which case, <code>uid</code> will contain the canonical form of the ID. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga14" doxytag="useracc.h::usr_injoth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_injoth           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structonlinerec__t.html">onlinerec_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>force</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Page another user with a message. 
<p>
`Injects' a string to another user (hence the name).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>user</em>&nbsp;</td><td>A pointer to the other user's <code><a class="el" href="structonlinerec__t.html">onlinerec_t</a></code>. You should obviously attach the other user's shared segment first, by calling <code><a class="el" href="group__useracc.html#ga13">usr_insys()</a></code>. As a side effect, this will also make sure the other user is actually on-line.</td></tr>
    <tr><td></td><td valign=top><em>msg</em>&nbsp;</td><td>A null-terminated string holding the message to send to the user. No need for the message to be fully formatted, but it should <em>in the other user's language</em>. Having attached the other user's online record, you know what language they're using. Use the function <code><a class="el" href="group__prompts.html#ga22">msg_getl()</a></code> to obtain prompts in the other user's language, and <code>sprintf()</code> to embed information in them. Any substitution variables in the string will be expanded in the other user's context. The string should be smaller than the maximum System V IPC message size, <code>MSGMAX</code> (4080 bytes on Linux, your mileage may vary). This is acceptable, though. You should aim to send really small messages to other users. Large ones are bound to be annoying in the superlative.</td></tr>
    <tr><td></td><td valign=top><em>force</em>&nbsp;</td><td>If non-zero, the function will not respect the <code>OLF_BUSY</code> flag in the user's online record, sending the message even if the user is unable to receive it. Never do this unless absolutely necessary. The system does this to notify the user of imminent disconnections, but that's usually an emergency for the user. Bear in mind that the user may not be able to receive the message immediately. Stored pages work this way.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the message could not be injected. One if it was successfully sent. This is asynchronous: the user may actually see the message at a later time.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><code><a class="el" href="group__useracc.html#ga15">usr_injoth_ack()</a></code>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga15" doxytag="useracc.h::usr_injoth_ack" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_injoth_ack           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structonlinerec__t.html">onlinerec_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ack</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>force</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Page another user with a message and acknowledgement. 
<p>
`Injects' a string to another user and sends back delivery ackowledgement to the original user. Injected messages are displayed asynchronously. If the recipient user is in the process of typing a line, the message will not appear until the user has pressed Enter (there's a way to force synchronous delivery, but it's not considered polite to the user because it disrupts their typing). However, the user may be unable to receive the message for a considerable length of time: maybe they're the Sysop and currently running a UNIX shell, or in the full screen editor. In such cases, it may be necessary to send an acknowledgement note back to the sender of the injected message when that message finally gets delivered. The /p(age) command does that if the recipient allows it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>user</em>&nbsp;</td><td>A pointer to the other user's <code><a class="el" href="structonlinerec__t.html">onlinerec_t</a></code>. You should obviously attach the other user's shared segment first, by calling { <a class="el" href="group__useracc.html#ga13">usr_insys()</a>}. As a side effect, this will also make sure the other user is actually on-line.</td></tr>
    <tr><td></td><td valign=top><em>msg</em>&nbsp;</td><td>A null-terminated string holding the message to send to the user. No need for the message to be fully formatted, but it should {<em>in</em> the other user's language}. Having attached the other user's online record, you know what language they're using. Use the function <code><a class="el" href="group__prompts.html#ga22">msg_getl()</a></code> to obtain prompts in the other user's language, and <code>sprintf()</code> to embed information in them. Any substitution variables in the string will be expanded in the other user's context.</td></tr>
    <tr><td></td><td valign=top><em>ack</em>&nbsp;</td><td>A null-terminated string holding the acknowledgement to be injected back to the original user upon delivery of the injected message. The total length of <code>msg</code> and <code>ack</code> must be less than the maximum System V IPC message size, <code>MSGMAX</code> (4080 bytes on Linux, your mileage may vary). This is acceptable, though. You should aim to send really small messages to other users. Large ones are bound to be annoying in the superlative.</td></tr>
    <tr><td></td><td valign=top><em>force</em>&nbsp;</td><td>If non-zero, the function will not respect the <code>OLF_BUSY</code> flag in the user's online record, sending the message even if the user is unable to receive it. Never do this unless absolutely necessary. The system does this to notify the user of imminent disconnections, but that's usually an emergency for the user. Bear in mind that the user may not be able to receive the message immediately. Stored pages work this way.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the message could not be injected. One if it was successfully sent. This is asynchronous: the user may actually see the message at a later time. An acknowledgement will eventually be injected back to the sender <em>only</em> if the return value is 1 (i.e. no errors have occurred).</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><code><a class="el" href="group__useracc.html#ga14">usr_injoth()</a></code>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga13" doxytag="useracc.h::usr_insys" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_insys           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>checkinvis</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check if a user is online and attach shared segment. 
<p>
Checks if the specified user is online, taking invisibility into account. If the user <em>is</em> online, the corresponding shared segment is attached as the `other user'.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>userid</em>&nbsp;</td><td>The user ID to check for. It need not be in canonical form; the function will call <code><a class="el" href="group__useracc.html#ga3">usr_exists()</a></code> internally.</td></tr>
    <tr><td></td><td valign=top><em>checkinvis</em>&nbsp;</td><td>If non-zero and the user is online but invisible, the function will pretend the user is not online. If <code>checkinvis</code> is zero and the user is online, invisibility is not taken into account and the function will not `lie'.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user is not online; one if they are. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga12" doxytag="useracc.h::usr_insystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_insystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>checkinvis</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structshmuserrec.html">shmuserrec</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check if a user is online (deprecated). 
<p>
Checks if the specified user is online, taking invisibility into account. If the user <em>is</em> online, the corresponding shared segment is attached and a pointer to it is returned.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>userid</em>&nbsp;</td><td>The canonical form of the user ID to operate on. You can use <code><a class="el" href="group__useracc.html#ga3">usr_exists()</a></code> to render a user ID in its canonical form.</td></tr>
    <tr><td></td><td valign=top><em>checkinvis</em>&nbsp;</td><td>If non-zero and the user is online but invisible, the function will pretend the user is not online. If <code>checkinvis</code> is zero and the user is online, invisibility is not taken into account and the function will not `lie'.</td></tr>
    <tr><td></td><td valign=top><em>buf</em>&nbsp;</td><td>A pointer (passed by reference) to a user shared segment. If the call is successful and user `<code>userid</code>' is online, the corresponding shared memory segment will be attached to this process and a pointer to the segment will be written to <code>buf</code>.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user is not online; one if they are.</dd></dl>
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000005">Deprecated:</a></b></dt><dd>Do not use this function. It is easy to misuse it. Please use the simpler <code><a class="el" href="group__useracc.html#ga13">usr_insys()</a></code> function that does not suffer from the same problems. This function is for internal use only. </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga13">usr_insys()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga4" doxytag="useracc.h::usr_loadaccount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_loadaccount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>whose</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structuseracc__t.html">useracc_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>uacc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a user account from file. 
<p>
Loads the specified account from disk. This function is called by the system. Under any normal circumstances, you won't need to call it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>whose</em>&nbsp;</td><td>The canonical form of the user ID to load. You can use <code><a class="el" href="group__useracc.html#ga3">usr_exists()</a></code> to obtain this.</td></tr>
    <tr><td></td><td valign=top><em>uacc</em>&nbsp;</td><td>A pointer to a pre-allocated <code><a class="el" href="structuseracc__t.html">useracc_t</a></code> to hold the account structure.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user could not be loaded, in which case, <code>errno</code> will be set to the error reported by the system. One if the user was loaded successfully, in which case the account will be in <code>uacc</code>.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga6">usr_saveaccount()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga5" doxytag="useracc.h::usr_loadonlrec" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_loadonlrec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>whose</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structonlinerec__t.html">onlinerec_t</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>onlrec</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a user online structure from file. 
<p>
Loads the specified structure from disk. Although online records are temporary and relatively volatile, they <em>are</em> saved to disk between module changes for security's sake. This function is called by the system. Under any normal circumstances, you won't need to call it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>whose</em>&nbsp;</td><td>The canonical form of the user ID to load. You can use <code><a class="el" href="group__useracc.html#ga3">usr_exists()</a></code> to obtain this.</td></tr>
    <tr><td></td><td valign=top><em>onlrec</em>&nbsp;</td><td>A pointer to a pre-allocated <code><a class="el" href="structonlinerec__t.html">onlinerec_t</a></code> to hold the online record.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user could not be loaded, in which case, <code>errno</code> will be set to the error reported by the system. One if the user was loaded successfully, in which case the account will be in <code>onlrec</code>.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga7">usr_saveonlrec()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga8" doxytag="useracc.h::usr_postcredits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void usr_postcredits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>amount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>paid</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Post credits to a user account. 
<p>
This function adds credits to a user's account. The user's shared segment is automatically attached in order to do this. In the process, the current `other' user's shared segment is detached and thus is no longer valid.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>userid</em>&nbsp;</td><td>Canonical form of the user ID to credit.</td></tr>
    <tr><td></td><td valign=top><em>amount</em>&nbsp;</td><td>The amount of credits to add. This may be negative to denote debiting of the account, but I don't recommend it, since this function has all the wrong semantics. Use <code><a class="el" href="group__useracc.html#ga9">usr_chargecredits()</a></code> to debit accounts.</td></tr>
    <tr><td></td><td valign=top><em>paid</em>&nbsp;</td><td>Can be <code>CRD_FREE} to denote free credits, or <code>CRD_PAID</code> for paid credits. Zero is the same as <code>CRD_FREE</code> and any non-zero value is the same as <code>CRD_PAID</code>.</code></td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><code> <a class="el" href="group__useracc.html#ga9">usr_chargecredits()</a>. </code></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga6" doxytag="useracc.h::usr_saveaccount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_saveaccount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structuseracc__t.html">useracc_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>uacc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write a user account to disk. 
<p>
Saves the specified account to disk. This function is called by the system. Under any normal circumstances, you won't need to call it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>uacc</em>&nbsp;</td><td>A pointer to a <code><a class="el" href="structuseracc__t.html">useracc_t</a></code> holding the account structure.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user could not be saved, in which case, <code>errno</code> will be set to the error reported by the system. One if the user was written successfully.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga4">usr_loadaccount()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga7" doxytag="useracc.h::usr_saveonlrec" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_saveonlrec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structonlinerec__t.html">onlinerec_t</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>onlrec</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write a user online record to disk. 
<p>
Saves the specified online record to disk. This function is called by the system. Under any normal circumstances, you won't need to call it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>onlrec</em>&nbsp;</td><td>Pointer to a <code><a class="el" href="structonlinerec__t.html">onlinerec_t</a></code> holding the online record to save.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the record could not be saved, in which case, <code>errno</code> will be set to the error reported by the system. One if the record was written successfully.</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__useracc.html#ga5">usr_loadonlrec()</a>. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga11" doxytag="useracc.h::usr_setclass" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void usr_setclass           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>newclass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>permanent</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change a user's class. 
<p>
Move a user to a new class.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>userid</em>&nbsp;</td><td>The canonical form of the user ID to operate on. You can use <code><a class="el" href="group__useracc.html#ga3">usr_exists()</a></code> to render a user ID in its canonical form.</td></tr>
    <tr><td></td><td valign=top><em>newclass</em>&nbsp;</td><td>The name of an existing class to move the user to. Use { <a class="el" href="group__useracc.html#ga2">cls_find()</a>} to make sure the class exists.</td></tr>
    <tr><td></td><td valign=top><em>permanent</em>&nbsp;</td><td>Set to zero if the change in class is temporary (i.e. only for today). Non-zero values denote a permanent change of class. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga16" doxytag="useracc.h::usr_uidxref" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int usr_uidxref           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>online</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
User ID completion. 
<p>
Completes A partially specified user ID, offering a menu of similar user IDs if the given ID was ambiguous. This function has two side effects:<p>
<ul>
<li>It renders user IDs in their canonical form, and</li></ul>
<p>
<ul>
<li>It attaches the final user IDs shared segment <em>if the user is online</em>.</li></ul>
<p>
Partial user IDs of less than three characters will not even be considered. Most systems have huge numbers of users with the same first couple of letters.<p>
If the partial user ID is found to be online, it is canonicalised and the function returns immediately. The user's shared segment is also attached.<p>
Otherwise, the user ID is completed by building a list of all user IDs starting with the supplied user ID. If the list has only one member, the function returns it (and attaches the user's shared segment, if online).<p>
If more than one user IDs match the partial, provided ID, the user is presented with a menu of the matching user IDs. At this point, the user can either select one of those user IDs by number, or enter an altogether new (possibly partial) user ID and the function will begin all over again. At any rate, if the user selects a user ID, the name is returned and the other user's shared segment is attached, if that user is online. Complicated, eh?<p>
Oh, by the way, this function ends command concatenation if it is forced to present a menu. This makes sense, because the user wasn't expecting this, and it's probably best to not make any potentially dangerous assumptions about the operation being performed.<p>
This completion function should be used wherever the system asks for (or expects) a user ID. The <code><a class="el" href="group__inp__hilevel.html#ga2">get_userid()</a></code> high-level input function uses it. Even normally non-interactive parts of the system use it, like the {<em>page}</em> global command (<code>/p</code>). I thoroughly recommend duplicating this behaviour for any other strings that can be numerous, long and/or complicated.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td></td><td valign=top><em>userid</em>&nbsp;</td><td>A partially specified user ID. After successful completion of this function, the canonical form of the full user ID will overwrite this argument.</td></tr>
    <tr><td></td><td valign=top><em>online</em>&nbsp;</td><td>If non-zero, the function will only consider users currently on-line for completion, ignoring all other users.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero if the user pressed <code>X</code> at the user ID selection menu. If this occurs, you should cancel whatever operation is in progress. If all went well and a user ID was located, a value of one is returned. </dd></dl>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="ga0" doxytag="useracc.h::cls_classes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structclassrec__t.html">classrec_t</a>* <a class="el" href="group__useracc.html#ga0">cls_classes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Array of all defined user classes. 
<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01142">1142</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ga1" doxytag="useracc.h::cls_count" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="group__useracc.html#ga1">cls_count</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Number of classes in <code>cls_classes</code>. 
<p>

<p>
Definition at line <a class="el" href="useracc_8h-source.html#l01143">1143</a> of file <a class="el" href="useracc_8h-source.html">useracc.h</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu Jul 15 16:04:03 2004 for Megistos API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
